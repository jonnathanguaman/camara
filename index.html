<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    
            <div class="oe_structure">
                <form action="/formulario/recepcion/save" method="post" enctype="multipart/form-data">
                    <div class="container-fluid" style="max-width: 1200px; margin: 0 auto; padding: 30px; background-color: #f8f9fa;">
                        <div style="background-color: white; padding: 40px; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.1);">
                            
                            <!-- Header -->
                            <div style="text-align: center; margin-bottom: 40px; border-bottom: 3px solid #007bff; padding-bottom: 20px;">
                                <h1 style="color: #2c3e50; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; font-weight: 600; font-size: 28px; margin: 0; letter-spacing: 1px;">
                                    REGISTRO PARA RECEPCI√ìN DE QU√çMICOS, MATERIALES E INSUMOS DIRECTOS
                                </h1>
                                <div style="margin-top: 10px; color: #6c757d; font-size: 14px;">
                                    SIG MM-R1.1.1.1/4.0 11-23
                                </div>
                            </div>

                            <!-- Informaci√≥n Principal -->
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px; margin-bottom: 40px;">
                                <div style="background-color: #f8f9fa; padding: 25px; border-radius: 8px; border-left: 4px solid #007bff;">
                                    <div style="margin-bottom: 15px;">
                                        <label style="font-weight: 600; color: #495057; display: block; margin-bottom: 5px;">FECHA:</label>
                                        <input type="date" name="fecha" required="true" style="width: 100%; padding: 10px; border: 1px solid #ced4da; border-radius: 4px; font-size: 14px;"/>
                                    </div>
                                    <div style="margin-bottom: 15px;">
                                        <label style="font-weight: 600; color: #495057; display: block; margin-bottom: 5px;">FECHA DE ELABORACI√ìN:</label>
                                        <input type="date" name="fecha_elaboracion" style="width: 100%; padding: 10px; border: 1px solid #ced4da; border-radius: 4px; font-size: 14px;"/>
                                    </div>
                                    <div>
                                        <label style="font-weight: 600; color: #495057; display: block; margin-bottom: 5px;">CANTIDAD RECIBIDA:</label>
                                        <input type="text" name="cantidad_recibida" placeholder="Ingrese cantidad" style="width: 100%; padding: 10px; border: 1px solid #ced4da; border-radius: 4px; font-size: 14px;"/>
                                    </div>
                                </div>
                                
                                <div style="background-color: #f8f9fa; padding: 25px; border-radius: 8px; border-left: 4px solid #28a745;">
                                    <div style="margin-bottom: 15px;">
                                        <label style="font-weight: 600; color: #495057; display: block; margin-bottom: 5px;">PROVEEDOR:</label>
                                        <input type="text" name="proveedor" placeholder="Nombre del proveedor" style="width: 100%; padding: 10px; border: 1px solid #ced4da; border-radius: 4px; font-size: 14px;"/>
                                    </div>
                                    <div style="margin-bottom: 15px;">
                                        <label style="font-weight: 600; color: #495057; display: block; margin-bottom: 5px;">FECHA DE EXPIRACI√ìN:</label>
                                        <input type="date" name="fecha_expiracion" style="width: 100%; padding: 10px; border: 1px solid #ced4da; border-radius: 4px; font-size: 14px;"/>
                                    </div>
                                    <div>
                                        <label style="font-weight: 600; color: #495057; display: block; margin-bottom: 5px;">LOTE:</label>
                                        <input type="text" name="lote" placeholder="N√∫mero de lote" style="width: 100%; padding: 10px; border: 1px solid #ced4da; border-radius: 4px; font-size: 14px;"/>
                                    </div>
                                </div>
                            </div>

                            <!-- Producto -->
                            <div style="margin-bottom: 40px; background-color: #f8f9fa; padding: 25px; border-radius: 8px; border-left: 4px solid #ffc107;">
                                <label style="font-weight: 600; color: #495057; display: block; margin-bottom: 10px; font-size: 16px;">PRODUCTO:</label>
                                <textarea name="producto" placeholder="Descripci√≥n detallada del producto" style="width: 100%; padding: 15px; border: 1px solid #ced4da; border-radius: 4px; font-size: 14px; min-height: 80px; resize: vertical;"></textarea>
                            </div>

                        <!-- Secci√≥n Condiciones del Transporte -->
                        <div style="margin-bottom: 30px;">
                            <h2 style="color: #2c3e50; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; font-weight: 600; font-size: 24px; margin-bottom: 25px; padding-bottom: 15px; border-bottom: 2px solid #e9ecef;">
                                A. CONDICIONES DEL TRANSPORTE
                            </h2>
                            
                            <div style="background-color: white; border-radius: 8px; overflow: hidden; box-shadow: 0 2px 8px rgba(0,0,0,0.08);">
                                <table style="width: 100%; border-collapse: collapse; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;">
                                    <thead>
                                        <tr style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">
                                            <th style="padding: 18px 20px; text-align: left; font-weight: 600; font-size: 16px; border: none;">Condici√≥n</th>
                                            <th style="padding: 18px 20px; text-align: center; font-weight: 600; font-size: 16px; border: none; width: 200px;">Cumple</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr style="border-bottom: 1px solid #e9ecef; transition: background-color 0.2s;">
                                            <td style="padding: 20px; color: #495057; font-size: 14px; line-height: 1.5; border: none;">
                                                Los productos transportados se encuentran aislados del ambiente (agua, polvo, etc.)
                                            </td>
                                            <td style="text-align: center; padding: 20px; border: none;">
                                                <div style="display: flex; justify-content: center; gap: 15px;">
                                                    <label style="display: flex; align-items: center; cursor: pointer; font-weight: 500; color: #28a745;">
                                                        <input type="radio" name="cond1" value="si" style="margin-right: 5px; transform: scale(1.2);"/> S√≠
                                                    </label>
                                                    <label style="display: flex; align-items: center; cursor: pointer; font-weight: 500; color: #dc3545;">
                                                        <input type="radio" name="cond1" value="no" style="margin-right: 5px; transform: scale(1.2);"/> No
                                                    </label>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr style="background-color: #f8f9fa; border-bottom: 1px solid #e9ecef; transition: background-color 0.2s;">
                                            <td style="padding: 20px; color: #495057; font-size: 14px; line-height: 1.5; border: none;">
                                                Condiciones internas de transporte en buen estado e higiene.
                                            </td>
                                            <td style="text-align: center; padding: 20px; border: none;">
                                                <div style="display: flex; justify-content: center; gap: 15px;">
                                                    <label style="display: flex; align-items: center; cursor: pointer; font-weight: 500; color: #28a745;">
                                                        <input type="radio" name="cond2" value="si" style="margin-right: 5px; transform: scale(1.2);"/> S√≠
                                                    </label>
                                                    <label style="display: flex; align-items: center; cursor: pointer; font-weight: 500; color: #dc3545;">
                                                        <input type="radio" name="cond2" value="no" style="margin-right: 5px; transform: scale(1.2);"/> No
                                                    </label>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr style="border-bottom: 1px solid #e9ecef; transition: background-color 0.2s;">
                                            <td style="padding: 20px; color: #495057; font-size: 14px; line-height: 1.5; border: none;">
                                                El √°rea de transporte de mercader√≠a se encuentra en buenas condiciones f√≠sicas.
                                            </td>
                                            <td style="text-align: center; padding: 20px; border: none;">
                                                <div style="display: flex; justify-content: center; gap: 15px;">
                                                    <label style="display: flex; align-items: center; cursor: pointer; font-weight: 500; color: #28a745;">
                                                        <input type="radio" name="cond3" value="si" style="margin-right: 5px; transform: scale(1.2);"/> S√≠
                                                    </label>
                                                    <label style="display: flex; align-items: center; cursor: pointer; font-weight: 500; color: #dc3545;">
                                                        <input type="radio" name="cond3" value="no" style="margin-right: 5px; transform: scale(1.2);"/> No
                                                    </label>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr style="background-color: #f8f9fa; border-bottom: 1px solid #e9ecef; transition: background-color 0.2s;">
                                            <td style="padding: 20px; color: #495057; font-size: 14px; line-height: 1.5; border: none;">
                                                Ausencia total de plagas o indicios de su existencia.
                                            </td>
                                            <td style="text-align: center; padding: 20px; border: none;">
                                                <div style="display: flex; justify-content: center; gap: 15px;">
                                                    <label style="display: flex; align-items: center; cursor: pointer; font-weight: 500; color: #28a745;">
                                                        <input type="radio" name="cond4" value="si" style="margin-right: 5px; transform: scale(1.2);"/> S√≠
                                                    </label>
                                                    <label style="display: flex; align-items: center; cursor: pointer; font-weight: 500; color: #dc3545;">
                                                        <input type="radio" name="cond4" value="no" style="margin-right: 5px; transform: scale(1.2);"/> No
                                                    </label>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr style="border-bottom: 1px solid #e9ecef; transition: background-color 0.2s;">
                                            <td style="padding: 20px; color: #495057; font-size: 14px; line-height: 1.5; border: none;">
                                                Los productos de grado alimenticio no han sido transportados con qu√≠micos que se consideren t√≥xicos o combustibles.
                                            </td>
                                            <td style="text-align: center; padding: 20px; border: none;">
                                                <div style="display: flex; justify-content: center; gap: 15px;">
                                                    <label style="display: flex; align-items: center; cursor: pointer; font-weight: 500; color: #28a745;">
                                                        <input type="radio" name="cond5" value="si" style="margin-right: 5px; transform: scale(1.2);"/> S√≠
                                                    </label>
                                                    <label style="display: flex; align-items: center; cursor: pointer; font-weight: 500; color: #dc3545;">
                                                        <input type="radio" name="cond5" value="no" style="margin-right: 5px; transform: scale(1.2);"/> No
                                                    </label>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr style="background-color: #f8f9fa; border-bottom: 1px solid #e9ecef; transition: background-color 0.2s;">
                                            <td style="padding: 20px; color: #495057; font-size: 14px; line-height: 1.5; border: none;">
                                                No hay indicio de producto derramado de env√≠os anteriores.
                                            </td>
                                            <td style="text-align: center; padding: 20px; border: none;">
                                                <div style="display: flex; justify-content: center; gap: 15px;">
                                                    <label style="display: flex; align-items: center; cursor: pointer; font-weight: 500; color: #28a745;">
                                                        <input type="radio" name="cond6" value="si" style="margin-right: 5px; transform: scale(1.2);"/> S√≠
                                                    </label>
                                                    <label style="display: flex; align-items: center; cursor: pointer; font-weight: 500; color: #dc3545;">
                                                        <input type="radio" name="cond6" value="no" style="margin-right: 5px; transform: scale(1.2);"/> No
                                                    </label>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr style="border-bottom: 1px solid #e9ecef;">
                                            <td style="padding: 20px; color: #495057; font-size: 14px; line-height: 1.5; border: none;">
                                                <strong>Evidencia visual que demuestre que el veh√≠culo utilizado est√° limpio, libre de residuos, sin da√±os visibles y sin presencia o indicios de plagas.</strong>
                                                <br/><small style="color: #6c757d; margin-top: 5px; display: block;">Debe incluir im√°genes del interior del cami√≥n (pisos, paredes, techo) y condiciones generales del √°rea de carga.</small>
                                            </td>
                                            <td style="text-align: center; padding: 20px; border: none; vertical-align: top;">
                                                <button type="button" onclick="abrirCamara()" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; border-radius: 8px; padding: 12px 20px; font-size: 14px; font-weight: 600; cursor: pointer; transition: transform 0.2s, box-shadow 0.2s; box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);">
                                                    üì∑ TOMAR FOTO
                                                </button>
                                                <canvas id="canvas" style="display: none;"></canvas>
                                                <video id="video" style="display: none; max-width: 250px; border-radius: 8px; margin-top: 15px; box-shadow: 0 4px 12px rgba(0,0,0,0.1);" autoplay="true"></video>
                                                <div id="fotos-tomadas" style="margin-top: 15px;"></div>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <!-- Secci√≥n B. Condiciones de Proveedor y Producto -->
                        <div style="margin-bottom: 30px;">
                            <h2 style="color: #2c3e50; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; font-weight: 600; font-size: 24px; margin-bottom: 25px; padding-bottom: 15px; border-bottom: 2px solid #e9ecef;">
                                B. CONDICIONES DE PROVEEDOR Y PRODUCTO
                            </h2>
                            
                            <div style="background-color: white; border-radius: 8px; overflow: hidden; box-shadow: 0 2px 8px rgba(0,0,0,0.08);">
                                <table style="width: 100%; border-collapse: collapse; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;">
                                    <thead>
                                        <tr style="background: linear-gradient(135deg, #fd7e14 0%, #e83e8c 100%); color: white;">
                                            <th style="padding: 18px 20px; text-align: left; font-weight: 600; font-size: 16px; border: none;">Condici√≥n</th>
                                            <th style="padding: 18px 20px; text-align: center; font-weight: 600; font-size: 16px; border: none; width: 200px;">Cumple</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr style="border-bottom: 1px solid #e9ecef; transition: background-color 0.2s;">
                                            <td style="padding: 20px; color: #495057; font-size: 14px; line-height: 1.5; border: none;">
                                                Hoja t√©cnica y seguridad y/o Certificado de an√°lisis (COA) o carta de garant√≠a.
                                            </td>
                                            <td style="text-align: center; padding: 20px; border: none;">
                                                <div style="display: flex; justify-content: center; gap: 15px;">
                                                    <label style="display: flex; align-items: center; cursor: pointer; font-weight: 500; color: #28a745;">
                                                        <input type="radio" name="condB1" value="si" style="margin-right: 5px; transform: scale(1.2);"/> S√≠
                                                    </label>
                                                    <label style="display: flex; align-items: center; cursor: pointer; font-weight: 500; color: #dc3545;">
                                                        <input type="radio" name="condB1" value="no" style="margin-right: 5px; transform: scale(1.2);"/> No
                                                    </label>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr style="background-color: #f8f9fa; border-bottom: 1px solid #e9ecef; transition: background-color 0.2s;">
                                            <td style="padding: 20px; color: #495057; font-size: 14px; line-height: 1.5; border: none;">
                                                Etiquetado legible y en buen estado en todos los productos.
                                            </td>
                                            <td style="text-align: center; padding: 20px; border: none;">
                                                <div style="display: flex; justify-content: center; gap: 15px;">
                                                    <label style="display: flex; align-items: center; cursor: pointer; font-weight: 500; color: #28a745;">
                                                        <input type="radio" name="condB2" value="si" style="margin-right: 5px; transform: scale(1.2);"/> S√≠
                                                    </label>
                                                    <label style="display: flex; align-items: center; cursor: pointer; font-weight: 500; color: #dc3545;">
                                                        <input type="radio" name="condB2" value="no" style="margin-right: 5px; transform: scale(1.2);"/> No
                                                    </label>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr style="border-bottom: 1px solid #e9ecef; transition: background-color 0.2s;">
                                            <td style="padding: 20px; color: #495057; font-size: 14px; line-height: 1.5; border: none;">
                                                Cuenta con un adecuado embalaje.
                                            </td>
                                            <td style="text-align: center; padding: 20px; border: none;">
                                                <div style="display: flex; justify-content: center; gap: 15px;">
                                                    <label style="display: flex; align-items: center; cursor: pointer; font-weight: 500; color: #28a745;">
                                                        <input type="radio" name="condB3" value="si" style="margin-right: 5px; transform: scale(1.2);"/> S√≠
                                                    </label>
                                                    <label style="display: flex; align-items: center; cursor: pointer; font-weight: 500; color: #dc3545;">
                                                        <input type="radio" name="condB3" value="no" style="margin-right: 5px; transform: scale(1.2);"/> No
                                                    </label>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr style="background-color: #f8f9fa; border-bottom: 1px solid #e9ecef; transition: background-color 0.2s;">
                                            <td style="padding: 20px; color: #495057; font-size: 14px; line-height: 1.5; border: none;">
                                                Ausencia total de producto derramado.
                                            </td>
                                            <td style="text-align: center; padding: 20px; border: none;">
                                                <div style="display: flex; justify-content: center; gap: 15px;">
                                                    <label style="display: flex; align-items: center; cursor: pointer; font-weight: 500; color: #28a745;">
                                                        <input type="radio" name="condB4" value="si" style="margin-right: 5px; transform: scale(1.2);"/> S√≠
                                                    </label>
                                                    <label style="display: flex; align-items: center; cursor: pointer; font-weight: 500; color: #dc3545;">
                                                        <input type="radio" name="condB4" value="no" style="margin-right: 5px; transform: scale(1.2);"/> No
                                                    </label>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr style="border-bottom: 1px solid #e9ecef; transition: background-color 0.2s;">
                                            <td style="padding: 20px; color: #495057; font-size: 14px; line-height: 1.5; border: none;">
                                                Todo el producto tiene el empaque en buen estado.
                                            </td>
                                            <td style="text-align: center; padding: 20px; border: none;">
                                                <div style="display: flex; justify-content: center; gap: 15px;">
                                                    <label style="display: flex; align-items: center; cursor: pointer; font-weight: 500; color: #28a745;">
                                                        <input type="radio" name="condB5" value="si" style="margin-right: 5px; transform: scale(1.2);"/> S√≠
                                                    </label>
                                                    <label style="display: flex; align-items: center; cursor: pointer; font-weight: 500; color: #dc3545;">
                                                        <input type="radio" name="condB5" value="no" style="margin-right: 5px; transform: scale(1.2);"/> No
                                                    </label>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr style="background-color: #f8f9fa; border-bottom: 1px solid #e9ecef; transition: background-color 0.2s;">
                                            <td style="padding: 20px; color: #495057; font-size: 14px; line-height: 1.5; border: none;">
                                                La factura est√° acorde con la orden de compra en cantidades y valor
                                            </td>
                                            <td style="text-align: center; padding: 20px; border: none;">
                                                <div style="display: flex; justify-content: center; gap: 15px;">
                                                    <label style="display: flex; align-items: center; cursor: pointer; font-weight: 500; color: #28a745;">
                                                        <input type="radio" name="condB6" value="si" style="margin-right: 5px; transform: scale(1.2);"/> S√≠
                                                    </label>
                                                    <label style="display: flex; align-items: center; cursor: pointer; font-weight: 500; color: #dc3545;">
                                                        <input type="radio" name="condB6" value="no" style="margin-right: 5px; transform: scale(1.2);"/> No
                                                    </label>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr style="border-bottom: 1px solid #e9ecef;">
                                            <td style="padding: 20px; color: #495057; font-size: 14px; line-height: 1.5; border: none;">
                                                <strong>Evidencia visual que refleje el estado f√≠sico del producto al momento de la recepci√≥n: etiquetas legibles, envases √≠ntegros, sin derrames, sin da√±os visibles y debidamente identificados.</strong>
                                                <br/><small style="color: #6c757d; margin-top: 5px; display: block;">Idealmente incluir n√∫mero de lote y fecha de vencimiento visibles.</small>
                                            </td>
                                            <td style="text-align: center; padding: 20px; border: none; vertical-align: top;">
                                                <button type="button" onclick="abrirCamaraB()" style="background: linear-gradient(135deg, #fd7e14 0%, #e83e8c 100%); color: white; border: none; border-radius: 8px; padding: 12px 20px; font-size: 14px; font-weight: 600; cursor: pointer; transition: transform 0.2s, box-shadow 0.2s; box-shadow: 0 4px 12px rgba(253, 126, 20, 0.3);">
                                                    üì∑ TOMAR FOTO
                                                </button>
                                                <canvas id="canvasB" style="display: none;"></canvas>
                                                <video id="videoB" style="display: none; max-width: 250px; border-radius: 8px; margin-top: 15px; box-shadow: 0 4px 12px rgba(0,0,0,0.1);" autoplay="true"></video>
                                                <div id="fotos-tomadasB" style="margin-top: 15px;"></div>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <!-- Secci√≥n C. Condiciones Especiales de Transporte -->
                        <div style="margin-bottom: 30px;">
                            <h2 style="color: #2c3e50; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; font-weight: 600; font-size: 24px; margin-bottom: 25px; padding-bottom: 15px; border-bottom: 2px solid #e9ecef;">
                                C. CONDICIONES ESPECIALES DE TRANSPORTE
                            </h2>
                            
                            <div style="background-color: white; border-radius: 8px; overflow: hidden; box-shadow: 0 2px 8px rgba(0,0,0,0.08);">
                                <table style="width: 100%; border-collapse: collapse; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;">
                                    <thead>
                                        <tr style="background: linear-gradient(135deg, #17a2b8 0%, #138496 100%); color: white;">
                                            <th style="padding: 18px 20px; text-align: left; font-weight: 600; font-size: 16px; border: none;">Condici√≥n</th>
                                            <th style="padding: 18px 20px; text-align: center; font-weight: 600; font-size: 16px; border: none; width: 100px;">SI</th>
                                            <th style="padding: 18px 20px; text-align: center; font-weight: 600; font-size: 16px; border: none; width: 100px;">NO</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr style="border-bottom: 1px solid #e9ecef; transition: background-color 0.2s;">
                                            <td style="padding: 20px; color: #495057; font-size: 14px; line-height: 1.5; border: none;">
                                                Requiere el producto ser transportado a temperatura especial (refrigeraci√≥n, congelaci√≥n):
                                            </td>
                                            <td style="text-align: center; padding: 20px; border: none;">
                                                <label style="cursor: pointer;">
                                                    <input type="radio" name="condC1" value="si" style="transform: scale(1.2);"/>
                                                </label>
                                            </td>
                                            <td style="text-align: center; padding: 20px; border: none;">
                                                <label style="cursor: pointer;">
                                                    <input type="radio" name="condC1" value="no" style="transform: scale(1.2);"/>
                                                </label>
                                            </td>
                                        </tr>
                                        <tr style="background-color: #f8f9fa; border-bottom: 1px solid #e9ecef; transition: background-color 0.2s;">
                                            <td style="padding: 20px; color: #495057; font-size: 14px; line-height: 1.5; border: none;">
                                                Temperatura de llegada del producto (refrigeraci√≥n, congelaci√≥n):
                                            </td>
                                            <td style="text-align: center; padding: 20px; border: none;">
                                                <input type="number" placeholder="¬∞C" style="width: 60px; padding: 5px; border: 1px solid #ced4da; border-radius: 4px; text-align: center; font-size: 12px;"/>
                                            </td>
                                            <td style="text-align: center; padding: 20px; border: none;">
                                                <input type="number" placeholder="¬∞C" style="width: 60px; padding: 5px; border: 1px solid #ced4da; border-radius: 4px; text-align: center; font-size: 12px;"/>
                                            </td>
                                        </tr>
                                        <tr style="border-bottom: 1px solid #e9ecef;">
                                            <td style="padding: 20px; color: #495057; font-size: 14px; line-height: 1.5; border: none;">
                                                <strong>Debe anotarse la temperatura exacta, fecha, hora, nombre de quien realiza la medici√≥n e incluir fotograf√≠a.</strong>
                                            </td>
                                            <td colspan="2" style="text-align: center; padding: 20px; border: none; vertical-align: top;">
                                                <button type="button" onclick="abrirCamaraC()" style="background: linear-gradient(135deg, #17a2b8 0%, #138496 100%); color: white; border: none; border-radius: 8px; padding: 12px 20px; font-size: 14px; font-weight: 600; cursor: pointer; transition: transform 0.2s, box-shadow 0.2s; box-shadow: 0 4px 12px rgba(23, 162, 184, 0.3);">
                                                    üì∑ CARGAR IMAGEN
                                                </button>
                                                <canvas id="canvasC" style="display: none;"></canvas>
                                                <video id="videoC" style="display: none; max-width: 250px; border-radius: 8px; margin-top: 15px; box-shadow: 0 4px 12px rgba(0,0,0,0.1);" autoplay="true"></video>
                                                <div id="fotos-tomadasC" style="margin-top: 15px;"></div>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <!-- Secci√≥n D. Gesti√≥n de Al√©rgenos -->
                        <div style="margin-bottom: 30px;">
                            <h2 style="color: #2c3e50; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; font-weight: 600; font-size: 24px; margin-bottom: 25px; padding-bottom: 15px; border-bottom: 2px solid #e9ecef;">
                                D. GESTI√ìN DE AL√âRGENOS
                            </h2>
                            
                            <div style="background-color: white; border-radius: 8px; overflow: hidden; box-shadow: 0 2px 8px rgba(0,0,0,0.08);">
                                <table style="width: 100%; border-collapse: collapse; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;">
                                    <thead>
                                        <tr style="background: linear-gradient(135deg, #6f42c1 0%, #563d7c 100%); color: white;">
                                            <th style="padding: 18px 20px; text-align: left; font-weight: 600; font-size: 16px; border: none;">Condici√≥n</th>
                                            <th style="padding: 18px 20px; text-align: center; font-weight: 600; font-size: 16px; border: none; width: 100px;">SI</th>
                                            <th style="padding: 18px 20px; text-align: center; font-weight: 600; font-size: 16px; border: none; width: 100px;">NO</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr style="border-bottom: 1px solid #e9ecef; transition: background-color 0.2s;">
                                            <td style="padding: 20px; color: #495057; font-size: 14px; line-height: 1.5; border: none;">
                                                Es un al√©rgeno.
                                            </td>
                                            <td style="text-align: center; padding: 20px; border: none;">
                                                <label style="cursor: pointer;">
                                                    <input type="radio" name="condD1" value="si" style="transform: scale(1.2);"/>
                                                </label>
                                            </td>
                                            <td style="text-align: center; padding: 20px; border: none;">
                                                <label style="cursor: pointer;">
                                                    <input type="radio" name="condD1" value="no" style="transform: scale(1.2);"/>
                                                </label>
                                            </td>
                                        </tr>
                                        <tr style="background-color: #f8f9fa; border-bottom: 1px solid #e9ecef; transition: background-color 0.2s;">
                                            <td style="padding: 20px; color: #495057; font-size: 14px; line-height: 1.5; border: none;">
                                                El insumo est√° correctamente identificado y se mantienen condiciones adecuadas para prevenir la contaminaci√≥n cruzada.
                                            </td>
                                            <td style="text-align: center; padding: 20px; border: none;">
                                                <label style="cursor: pointer;">
                                                    <input type="radio" name="condD2" value="si" style="transform: scale(1.2);"/>
                                                </label>
                                            </td>
                                            <td style="text-align: center; padding: 20px; border: none;">
                                                <label style="cursor: pointer;">
                                                    <input type="radio" name="condD2" value="no" style="transform: scale(1.2);"/>
                                                </label>
                                            </td>
                                        </tr>
                                        <tr style="border-bottom: 1px solid #e9ecef;">
                                            <td style="padding: 20px; color: #495057; font-size: 14px; line-height: 1.5; border: none;">
                                                <strong>Evidencia visual o escrita que demuestre que el insumo est√° correctamente identificado como al√©rgeno (si aplica) y que se mantiene separado o en condiciones que previenen la contaminaci√≥n cruzada con otros productos no alerg√©nicos.</strong>
                                            </td>
                                            <td colspan="2" style="text-align: center; padding: 20px; border: none; vertical-align: top;">
                                                <button type="button" onclick="abrirCamaraD()" style="background: linear-gradient(135deg, #6f42c1 0%, #563d7c 100%); color: white; border: none; border-radius: 8px; padding: 12px 20px; font-size: 14px; font-weight: 600; cursor: pointer; transition: transform 0.2s, box-shadow 0.2s; box-shadow: 0 4px 12px rgba(111, 66, 193, 0.3);">
                                                    üì∑ CARGAR IMAGEN
                                                </button>
                                                <canvas id="canvasD" style="display: none;"></canvas>
                                                <video id="videoD" style="display: none; max-width: 250px; border-radius: 8px; margin-top: 15px; box-shadow: 0 4px 12px rgba(0,0,0,0.1);" autoplay="true"></video>
                                                <div id="fotos-tomadasD" style="margin-top: 15px;"></div>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <!-- Secci√≥n E: Observaciones y Datos Finales -->
                        <div class="section-container" style="margin-top: 30px;">
                            <h3 class="section-title" style="background: linear-gradient(135deg, #8B4513, #D2691E); color: white; padding: 10px; border-radius: 5px; text-align: center; margin-bottom: 20px;">
                                OBSERVACIONES Y DATOS FINALES
                            </h3>
                            
                            <!-- Observaciones -->
                            <div style="margin-bottom: 25px;">
                                <label style="font-weight: bold; display: block; margin-bottom: 10px; font-size: 14px;">OBSERVACIONES:</label>
                                <textarea name="observaciones" placeholder="Escriba sus observaciones aqu√≠..." style="width: 100%; padding: 10px; border: 1px solid #333; border-radius: 3px; min-height: 100px;"></textarea>
                            </div>

                            <!-- Datos de Transporte -->
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 25px;">
                                <div>
                                    <label style="font-weight: bold; display: block; margin-bottom: 5px;">TRANSPORTADO POR:</label>
                                    <input type="text" name="transportado_por" style="width: 100%; padding: 8px; border: 1px solid #333; border-radius: 3px;" />
                                </div>
                                <div>
                                    <label style="font-weight: bold; display: block; margin-bottom: 5px;">CHOFER:</label>
                                    <input type="text" name="chofer" style="width: 100%; padding: 8px; border: 1px solid #333; border-radius: 3px;" />
                                </div>
                            </div>

                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 30px;">
                                <div>
                                    <label style="font-weight: bold; display: block; margin-bottom: 5px;">PLACA:</label>
                                    <input type="text" name="placa" style="width: 100%; padding: 8px; border: 1px solid #333; border-radius: 3px;" />
                                </div>
                                <div>
                                    <label style="font-weight: bold; display: block; margin-bottom: 5px;">FIRMA:</label>
                                    <input type="text" name="firma" style="width: 100%; padding: 8px; border: 1px solid #333; border-radius: 3px;" />
                                </div>
                            </div>

                            <!-- Tabla de Listas -->
                            <table style="width: 100%; border-collapse: collapse; margin-top: 20px; border: 2px solid #333;">
                                <thead>
                                    <tr>
                                        <th style="border: 2px solid #333; padding: 15px; background: linear-gradient(135deg, #4CAF50, #45a049); color: white; text-align: center; font-weight: bold; font-size: 14px;">
                                            Elaborado por:<br />
                                            <span style="font-size: 16px; margin-top: 10px; display: block;">LISTA DE BODEGUEROS</span>
                                        </th>
                                        <th style="border: 2px solid #333; padding: 15px; background: linear-gradient(135deg, #2196F3, #1976D2); color: white; text-align: center; font-weight: bold; font-size: 14px;">
                                            Revisado por:<br />
                                            <span style="font-size: 16px; margin-top: 10px; display: block;">LISTA DE SUPERVISORES LOG√çSTICA</span>
                                        </th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td style="border: 2px solid #333; padding: 40px; height: 150px; vertical-align: top;">
                                            <!-- Espacio para lista de bodegueros -->
                                        </td>
                                        <td style="border: 2px solid #333; padding: 40px; height: 150px; vertical-align: top;">
                                            <!-- Espacio para lista de supervisores -->
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <!-- Bot√≥n de Env√≠o -->
                        <div style="text-align: center; margin-top: 40px;">
                            <button type="submit" style="background: linear-gradient(135deg, #28a745 0%, #20c997 100%); color: white; border: none; border-radius: 8px; padding: 15px 40px; font-size: 16px; font-weight: 600; cursor: pointer; transition: transform 0.2s, box-shadow 0.2s; box-shadow: 0 4px 12px rgba(40, 167, 69, 0.3);">
                                üìã GUARDAR REGISTRO
                            </button>
                        </div>
                    </div>
                </div>
        </form>
        </div>
        
        <script>
            // Variables globales
            const streams = {};
            const fotoContadores = {};
            const fotosCapturadas = {
                'A': [],
                'B': [],
                'C': [],
                'D': []
            };

            // Configuraci√≥n de botones
            const btnStyles = {
                capturar: `margin-top: 15px; padding: 10px 20px; background: linear-gradient(135deg, #28a745 0%, #20c997 100%); 
                        color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600; font-size: 14px;
                        transition: transform 0.2s, box-shadow 0.2s; box-shadow: 0 4px 12px rgba(40, 167, 69, 0.3); margin-right: 10px;`,
                cerrar: `margin-top: 15px; padding: 10px 20px; background: linear-gradient(135deg, #dc3545 0%, #c82333 100%); 
                        color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600; font-size: 14px;
                        transition: transform 0.2s, box-shadow 0.2s; box-shadow: 0 4px 12px rgba(220, 53, 69, 0.3);`
            };

            const secciones = {
                '': { color: '#667eea', titulo: 'üì∑ Fotos capturadas:' },
                'B': { color: '#fd7e14', titulo: 'üì∑ Fotos del producto:' },
                'C': { color: '#17a2b8', titulo: 'üì∑ Evidencia de temperatura:' },
                'D': { color: '#6f42c1', titulo: 'üì∑ Evidencia de al√©rgenos:' }
            };

            // Funci√≥n universal para abrir c√°mara
            async function abrirCamara(sufijo = '') {
                const video = document.getElementById(`video${sufijo}`);
                
                try {
                    const stream = await navigator.mediaDevices.getUserMedia({ 
                        video: { facingMode: 'environment', width: { ideal: 1280 }, height: { ideal: 720 } }
                    });
                    
                    streams[sufijo] = stream;
                    video.srcObject = stream;
                    video.style.display = 'block';
                    
                    crearBotones(sufijo, video.parentNode);
                    
                } catch (err) {
                    alert('Error al acceder a la c√°mara: ' + err.message);
                }
            }

            // Crear botones din√°micamente
            function crearBotones(sufijo, parent) {
                if (!document.getElementById(`btn-capturar${sufijo}`)) {
                    const btnCapturar = crearBoton(`btn-capturar${sufijo}`, 'üì∏ CAPTURAR', btnStyles.capturar, () => capturarFoto(sufijo));
                    const btnCerrar = crearBoton(`btn-cerrar${sufijo}`, '‚ùå CERRAR', btnStyles.cerrar, () => cerrarCamara(sufijo));
                    parent.appendChild(btnCapturar);
                    parent.appendChild(btnCerrar);
                }
            }

            // Crear bot√≥n con estilo y eventos
            function crearBoton(id, texto, estilo, onclick) {
                const btn = document.createElement('button');
                btn.id = id;
                btn.innerHTML = texto;
                btn.style.cssText = estilo;
                btn.onclick = onclick;
                btn.type = 'button'; // Importante para evitar submit del formulario
                btn.onmouseover = () => btn.style.transform = 'translateY(-2px)';
                btn.onmouseout = () => btn.style.transform = 'translateY(0)';
                return btn;
            }

            // Funci√≥n universal para capturar foto
            function capturarFoto(sufijo = '') {
                const video = document.getElementById(`video${sufijo}`);
                const canvas = document.getElementById(`canvas${sufijo}`);
                const ctx = canvas.getContext('2d');
                
                canvas.width = video.videoWidth;
                canvas.height = video.videoHeight;
                ctx.drawImage(video, 0, 0);
                
                // Obtener datos de la imagen
                const imageData = canvas.toDataURL('image/jpeg', 0.8);
                
                // Guardar en el array correspondiente
                const seccion = sufijo || 'A';
                fotosCapturadas[seccion].push(imageData);
                
                const img = document.createElement('img');
                img.src = imageData;
                img.style.cssText = `max-width: 120px; margin: 5px; border: 2px solid ${secciones[sufijo].color}; 
                                    border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); transition: transform 0.2s;`;
                img.onmouseover = () => img.style.transform = 'scale(1.05)';
                img.onmouseout = () => img.style.transform = 'scale(1)';
                
                fotoContadores[sufijo] = (fotoContadores[sufijo] || 0) + 1;
                const divFotos = document.getElementById(`fotos-tomadas${sufijo}`);
                
                if (fotoContadores[sufijo] === 1) {
                    divFotos.innerHTML = `<div style="color: #495057; font-weight: 600; margin-bottom: 10px;">${secciones[sufijo].titulo}</div>`;
                }
                
                divFotos.appendChild(img);
            }

            // Funci√≥n universal para cerrar c√°mara
            function cerrarCamara(sufijo = '') {
                if (streams[sufijo]) {
                    streams[sufijo].getTracks().forEach(track => track.stop());
                    delete streams[sufijo];
                }
                
                document.getElementById(`video${sufijo}`).style.display = 'none';
                
                const btnCapturar = document.getElementById(`btn-capturar${sufijo}`);
                const btnCerrar = document.getElementById(`btn-cerrar${sufijo}`);
                if (btnCapturar) btnCapturar.remove();
                if (btnCerrar) btnCerrar.remove();
            }

            // Funciones espec√≠ficas (mantienen compatibilidad)
            const abrirCamaraB = () => abrirCamara('B');
            const abrirCamaraC = () => abrirCamara('C');
            const abrirCamaraD = () => abrirCamara('D');

            // Preparar datos antes del env√≠o del formulario
            function prepararDatosFormulario() {
                const form = document.querySelector('form');
                
                // Agregar campos hidden para las fotos
                Object.keys(fotosCapturadas).forEach(seccion => {
                    if (fotosCapturadas[seccion].length > 0) {
                        const input = document.createElement('input');
                        input.type = 'hidden';
                        input.name = `fotos_${seccion}`;
                        input.value = JSON.stringify(fotosCapturadas[seccion].map((foto, index) => ({
                            imagen: foto.replace('data:image/jpeg;base64,', ''),
                            nombre: `Foto_${seccion}_${index + 1}`,
                            descripcion: `Evidencia secci√≥n ${seccion}`
                        })));
                        form.appendChild(input);
                    }
                });

                // Agregar datos de condiciones (solo las que tienen texto)
                ['A', 'B', 'C', 'D'].forEach(seccion => {
                    let condicionIndex = 0;
                    const condiciones = [];
                    
                    while (true) {
                        const condicionInput = document.querySelector(`input[name="condicion_${seccion}_${condicionIndex}"]`);
                        const cumpleSelect = document.querySelector(`select[name="cumple_${seccion}_${condicionIndex}"]`);
                        
                        if (!condicionInput) break;
                        
                        if (condicionInput.value.trim()) {
                            condiciones.push({
                                condicion: condicionInput.value.trim(),
                                cumple: cumpleSelect ? cumpleSelect.value : '',
                                observacion: ''
                            });
                        }
                        
                        condicionIndex++;
                    }
                    
                    if (condiciones.length > 0) {
                        const input = document.createElement('input');
                        input.type = 'hidden';
                        input.name = `condiciones_${seccion}`;
                        input.value = JSON.stringify(condiciones);
                        form.appendChild(input);
                    }
                });
            }

            // Eventos DOM
            document.addEventListener('DOMContentLoaded', function() {
                document.querySelectorAll('[style*="grid-template-columns"]').forEach(el => el.classList.add('grid-responsive'));
                document.querySelectorAll('table').forEach(el => el.classList.add('table-responsive'));
                
                // Agregar evento al formulario para preparar datos antes del env√≠o
                const form = document.querySelector('form');
                if (form) {
                    form.addEventListener('submit', function(e) {
                        prepararDatosFormulario();
                    });
                }
            });
            </script>

</body>
</html>